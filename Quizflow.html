<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Important Message</title>
    <link rel="stylesheet" href="styles.css">
    <script src="script.js" defer></script>
    <style>
        select {
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            appearance: none;
        }

        select option {
            background-color: rgb(80, 79, 79);
            color: white;
        }
    </style>
</head>

<body>

    <div class="container quiz-css" id="step1">
        <div class="">
            <div class="logo signup section">
                <div class="section-header">
                    <img src="./Assets/1.png" alt="Logo">
                    <span>
                        <h2>ipropaganda</h2>
                        <p>IDFY | MUSIC</p>
                    </span>
                </div>
                <div class="volume-control-header">
                    <img src="./Assets/Frame 4.png" alt="" />
                    <input type="range" id="volume" name="volume" min="0" max="100" value="50">
                    <img src="./Assets/Frame 3.png" alt="" />
                </div>
            </div>
            <hr />
            <div class="heading-main Disqualification">
                <div class="image-flex">
                    <div class="new-css-res">
                        <h3 id="tries-left">5 try left</h3> <!-- Updated ID for tracking tries -->
                    </div>
                    <img class="song-play" src="./Assets/Play@2x.png" alt="" id="play-button" />
                    <img class="song-notes" src="./Assets/Song notes.png" alt="" />
                </div>
                <div class="form-container">
                    <form class="song-form">
                        <label for="song-name">Song Name</label>
                        <input type="text" id="song-name" placeholder="Enter song name here...">

                        <label for="artist-name">Artist Name</label>
                        <input type="text" id="artist-name" placeholder="Enter artist name here...">

                        <label for="release-year">Year of Release</label>
                        <select id="release-year">
                            <option value="">Choose year of release from here</option>
                        </select>

                        <label for="genre">Genre of Song</label>
                        <select id="genre">
                            <option value="">Choose genre from here</option>
                        </select>

                        <button type="submit" id="submit-button">Submit</button>
                    </form>
                </div>

            </div>

        </div>

    </div>

    <!-- Add an audio element to play the song -->
    <audio id="audio-player"></audio>

    <script>
        const songs = [
            {
                "Song Name": "Block Party",
                "Artist Name": "Anthony White",
                "Year of Release": 1977,
                "Genre": "Disco",
                "File Path": "./Assets/Music snippets_ 1st 10 to developer/Block Party.mp3"
            },
            {
                "Song Name": "Cocomotion",
                "Artist Name": "El Coco",
                "Year of Release": 1977,
                "Genre": "Disco",
                "File Path": "./Assets/Music snippets_ 1st 10 to developer/Cocomotion.mp3"
            },
            {
                "Song Name": "It's Ecstasy When You Lay Down Next to Me",
                "Artist Name": "Barry White",
                "Year of Release": 1977,
                "Genre": "Disco",
                "File Path": "./Assets/Music snippets_ 1st 10 to developer/It's Ecstasy When You Lay Down Next to Me.mp3"
            }
            ,
            {
                "Song Name": "I Got to Have Your Love",
                "Artist Name": "Fantastic Four",
                "Year of Release": 1977,
                "Genre": "Disco",
                "File Path": "./Assets/Music snippets_ 1st 10 to developer/I Got to Have Your Love.mp3"
            },
            {
                "Song Name": "San Francisco",
                "Artist Name": "Village People",
                "Year of Release": 1977,
                "Genre": "Disco",
                "File Path": "./Assets/Music snippets_ 1st 10 to developer/San Francisco.mp3"
            },
            {
                "Song Name": "Misunderstood",
                "Artist Name": "Santa Esmeralda",
                "Year of Release": 1977,
                "Genre": "Disco",
                "File Path": "./Assets/Music snippets_ 1st 10 to developer/Misunderstood.mp3"
            },
            {
                "Song Name": "Native New Yorker",
                "Artist Name": "Odyssey",
                "Year of Release": 1977,
                "Genre": "Disco",
                "File Path": "./Assets/Music snippets_ 1st 10 to developer/Native New Yorker.mp3"
            },
            {
                "Song Name": "Dance, Dance, Dance",
                "Artist Name": "Chic",
                "Year of Release": 1977,
                "Genre": "Disco",
                "File Path": "./Assets/Music snippets_ 1st 10 to developer/Dance Dance Dance.mp3"
            },
            {
                "Song Name": "Cosmic Wind",
                "Artist Name": "Mike Theodore Orchestra",
                "Year of Release": 1977,
                "Genre": "Disco",
                "File Path": "./Assets/Music snippets_ 1st 10 to developer/Mike Theo orchestra.mp3"
            },
            {
                "Song Name": "Girl Don't Make Me Wait",
                "Artist Name": "Pattie Brooks",
                "Year of Release": 1977,
                "Genre": "Disco",
                "File Path": "./Assets/Music snippets_ 1st 10 to developer/Girl Don't Make Me Wait.mp3"
            }
        ];

        let currentSong = null;
        let triesLeft = 5; // Initialize tries left to 5
        let totalScore = 0; // Initialize the total score (125 total, 25 per correct answer)

        // Populate Year of Release dropdown with specific years
        const yearDropdown = document.getElementById('release-year');
        const years = [1977, 1978, 1987, 1988];
        years.forEach(year => {
            const yearOption = document.createElement('option');
            yearOption.value = year;
            yearOption.text = year;
            yearDropdown.appendChild(yearOption);
        });

        // Populate Genre of Song dropdown with options
        const genreDropdown = document.getElementById('genre');
        const genres = ["Disco", "Pop", "Rock", "Jazz"]; // You can add more genres here
        genres.forEach(genre => {
            const genreOption = document.createElement('option');
            genreOption.value = genre;
            genreOption.text = genre;
            genreDropdown.appendChild(genreOption);
        });

        // Get form elements
        const songNameInput = document.getElementById('song-name');
        const artistNameInput = document.getElementById('artist-name');
        const releaseYearSelect = document.getElementById('release-year');
        const genreSelect = document.getElementById('genre');
        const submitButton = document.getElementById('submit-button');
        const triesLeftDisplay = document.getElementById('tries-left');
        const playButton = document.getElementById('play-button');
        const audioPlayer = document.getElementById('audio-player');

        let isPlaying = false; // Flag to track the play state

        // Function to play a random song
        function playRandomSong() {
            currentSong = songs[Math.floor(Math.random() * songs.length)];
            audioPlayer.src = currentSong['File Path'];
            audioPlayer.play();
            playButton.src = './Assets/Vector.png'; // Change to pause button
            isPlaying = true;
        }

        // Initially disable the submit button
        submitButton.disabled = true;

        // Function to check if all fields have data
        function checkFormValidity() {
            if (
                songNameInput.value.trim() !== '' &&
                artistNameInput.value.trim() !== '' &&
                releaseYearSelect.value !== '' &&
                genreSelect.value !== ''
            ) {
                submitButton.disabled = false;
            } else {
                submitButton.disabled = true;
            }
        }

        // Add event listeners to form inputs and select elements
        songNameInput.addEventListener('input', checkFormValidity);
        artistNameInput.addEventListener('input', checkFormValidity);
        releaseYearSelect.addEventListener('change', checkFormValidity);
        genreSelect.addEventListener('change', checkFormValidity);

        // Play a random song when the play button is clicked
        playButton.addEventListener('click', () => {
            if (isPlaying) {
                audioPlayer.pause();
                playButton.src = './Assets/Play@2x.png';
                isPlaying = false;
            } else {
                playRandomSong();
            }
        });

        // Reset the button to Play@2x.png when the song ends
        audioPlayer.addEventListener('ended', () => {
            playButton.src = './Assets/Play@2x.png';
            isPlaying = false;
        });

        // Form submit handler
        const form = document.querySelector('.song-form');
        form.addEventListener('submit', (e) => {
            e.preventDefault(); // Prevent form from submitting

            const isCorrect = (
                songNameInput.value.trim().toLowerCase() === currentSong['Song Name'].toLowerCase() &&
                artistNameInput.value.trim().toLowerCase() === currentSong['Artist Name'].toLowerCase() &&
                releaseYearSelect.value == currentSong['Year of Release'] &&
                genreSelect.value === currentSong['Genre']
            );

            console.log(triesLeft)
            console.log(isCorrect)
            console.log(totalScore)

            if (isCorrect) {
                alert('Success! You guessed the correct song details.');
                totalScore += 25; // Add 25 points for correct answer
            } else {
                alert('Incorrect. Please try again.');
                triesLeft--; // Decrease tries by 1
                if (triesLeft === 0) {
                    alert('Game Over!');
                    window.location.href = 'ResultCard.html';

                }
            }

            // Update the "tries left" display
            triesLeftDisplay.textContent = `${triesLeft} tries left`;

            // Check if the user has completed 4 correct answers
            if (totalScore >= 100) {
                localStorage.setItem('totalScore', totalScore); // Save score to localStorage
                window.location.href = 'results.html'; // Redirect to results page
            }

            // Play a new song after submission
            playRandomSong();

            // Reset form fields
            form.reset();
            checkFormValidity(); // Disable submit button again
        });
    </script>

</body>

</html>